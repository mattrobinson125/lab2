---
title: "Lab2: Reproduce An Analysis!"
author: "Matt Robinson & Vincent Lee"
date: "9/26/2016"
output: html_document
---

## R Markdown

The following lines of code import necessary libraries to execute this code:

### Preparation / Imports
``` {r}
library(devtools)
library(flexdashboard)
library(lubridate)
library(dplyr)
library(ggplot2)
library(ggstance)
library(ggalt)
```

``` {r, eval =F}
install.packages("devtools")
install.packages("flexdashboard")
install.packages("lubridate")
install.packages("dplyr")
install.packages("ggplot2")
devtools::install_github("lionel-/ggstance")
install.packages("ggalt")
```

## Introduction

- Link to Article: https://www.r-bloggers.com/fatal-police-shootings-across-the-u-s/
- Link to Data: https://github.com/washingtonpost/data-police-shootings
- Link to the Visualization: https://gist.github.com/juliasilge/9acbe97c549502bac85404779edceba0

The data we imported is a compilition of every fatal shooting in the United States by a police officer in the line of duty from a database organized by the Washington Post since Jan. 1, 2015.

Since 2015, The Washington Post has recorded dozens of details about each killing:

- **id**: unique id of the person
- **name**: first, middle, and last name of the person
- **date** the date of the fatal shooting  
- **manner_of_death**: description of whether they were Beaten or Shot
- **armed**: whether the person killed was armed 
- **age**: person's age
- **gender**: Male or Female
- **race**: includes the race of the deceased
- **city**: location of city area
- **state**: location of state
- **threat level**: the circumstances of the shooting
- **signs_of_mental_illness**: whether the victim was experiencing a mental-health crisis 
- **flee**: were they running away by Foot, Not Fleeing, Car
- **body_camera**: was the victim 's body recorded by a camera

In 2016, The Washington post went to gatheradditional information about each fatal shooting that occurred during this year. There were reports, websites, and social media that have been monitoring independent databases about fatal police shootings. More than a dozen additional details were collected about the officers in each shooting. 

We want to look at the data and make an in-depth analysis on the different demographic, date, location, and circumstance of death within Fatal Shootings.

## Analysis

We imported the data set obtained from the Washington Post police shootings database. Then, we clean up the code by changing dates, genders, races, and manners of death to an understandable format.
```{r}
fatalshootings <- read.csv("./fatal-police-shootings-data.csv", stringsAsFactors = FALSE)
fatalshootings$date <- ymd(fatalshootings$date)
fatalshootings[,c(4:5,7:8,9:14)] <- lapply(fatalshootings[,c(4:5,7:8,9:14)], as.factor)
levels(fatalshootings$gender) <- c("Female", "Male")
levels(fatalshootings$race) <- c("Unknown", "Asian", "Black", "Hispanic", "Unknown", "Other", "White")
fatalshootings$race <- factor(fatalshootings$race, levels(fatalshootings$race)[c(5,2,1,4,3,6)])
levels(fatalshootings$flee) <- c("Unknown", "Car", "Foot", "Not fleeing", "Other")
fatalshootings$flee <- factor(fatalshootings$flee, levels(fatalshootings$flee)[c(1,5,3,2,4)])
levels(fatalshootings$manner_of_death) <- c("Beaten", "Shot", "Shot/Tasered")
fatalshootings$manner_of_death <- factor(fatalshootings$manner_of_death, levels(fatalshootings$manner_of_death)[c(1,3,2)])
```

### Race/Ethnicity
```{r}
ggplot(data = fatalshootings, aes(y = race)) + 
        geom_barh(aes(fill = ..count..)) +
        theme_minimal(base_size = 13) +
        theme(legend.position = "none") +
        scale_x_continuous(expand=c(0,0)) +
        scale_fill_gradient(low = "royalblue3", high = "navyblue") +
        labs(y = NULL, x = "Number of deaths")
```
This is a simple graph yet you can interpret alot in terms of data. Instead of the typical vertical graph the original creator decided to make it horizontal. They also set a darker gradient for large numbers of Fatal Shootings. Overall, good use of whitespace and direction. One can clearly tell which ethinicity suffers the most. My only question is what categorizes the unknown.

### Dates Overall 
```{r}
ggplot(data = fatalshootings, aes(x = date)) + 
        geom_histogram(aes(fill = ..count..), bins = 25) +
        theme_minimal() +
        theme(legend.position = "none") +
        scale_fill_gradient(low = "royalblue3", high = "navyblue") +
        labs(x = NULL, y = "Number of deaths")
```
When creating the flexboard, it's good that there is a consistant theme. The creator continues the trend of darker gradient for large numbers. Also I think it was a good call to minimize it to only 25 bins.


### Top 15 States For Fatal Police Shootings
```{r}
stateinfo <- fatalshootings %>% group_by(state) %>% summarise(n = n()) %>% 
        arrange(desc(n)) %>% top_n(15) %>% 
        mutate(state = factor(state, levels = rev(unique(state))))
ggplot(stateinfo, aes(x = n, y = state)) +
        geom_barh(stat="identity", aes(fill = n)) +
        #geom_stateface(aes(y=state, x=7, label=as.character(state)), colour="white", size=8) +
        geom_text(aes(x = 17, y = state, label=as.character(state)), color="white", size=5) +
        labs(y = NULL, x = "Number of deaths") +
        scale_fill_gradient(low = "royalblue3", high = "navyblue") +
        theme_minimal(base_size = 13) +
        theme(axis.text.y=element_blank()) +
        theme(legend.position = "none") +
        scale_x_continuous(expand=c(0,0))
```
This graph is a little bit more complicated than the rest. The creator focuses on seperating the top 15 states and finding the distinct variables. Then the creator maps it to the barplot. Original there were

### Was The Person Killed Armed
```{r}
armedinfo <- fatalshootings %>% group_by(armed) %>% summarise(n = n()) %>% 
        arrange(desc(n)) %>% top_n(10) %>% 
        mutate(armed = factor(armed, levels = rev(unique(armed))))

ggplot(data = armedinfo, aes(x = n, y = armed)) + 
        geom_barh(stat="identity", aes(fill = n)) +
        theme_minimal(base_size = 13) +
        theme(legend.position = "none") +
        scale_x_continuous(expand=c(0,0)) +
        scale_fill_gradient(low = "royalblue3", high = "navyblue") +
        labs(y = NULL, x = "Number of deaths")
```


## Follow-Up / Data Visualization

Our twist on the fatal police shootings data.

Import the csv file.
```{r}
fatal_data = read.csv("fatal-police-shootings-data.csv")
```

Simple analysis without making graphical models (throw it into a simple barplot if you do want to make a graphical model)
```{r}
table(data$armed)
table(data$manner_of_death)
table(data$age)
table(data$gender)
table(data$race)
table(data$state)
table(data$signs_of_mental_illness)
table(data$threat_level)
table(data$flee)
table(data$body_camera)
```

Data Visualization.
```{r}

```


## Conclusion

- We could've definitely looked into using other varibles for supporting our Data Analysis.
- If we had time, the stretch goal was to create a graphical map visualization or an interactive visualization where people can hover over the data.

